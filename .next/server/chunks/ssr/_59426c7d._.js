module.exports=[67453,a=>{"use strict";let b=(0,a.i(70106).default)("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);a.s(["CheckCircle2",()=>b],67453)},56738,a=>{"use strict";let b=(0,a.i(70106).default)("wallet",[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]]);a.s(["Wallet",()=>b],56738)},96221,a=>{"use strict";let b=(0,a.i(70106).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);a.s(["Loader2",()=>b],96221)},18767,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(10849),e=a.i(56025),f=a.i(60246),g=a.i(70106);let h=(0,g.default)("activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);var i=a.i(67453),j=a.i(56738),k=a.i(41675);let l=(0,g.default)("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),m=(0,g.default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]),n=(0,g.default)("user-plus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);var o=a.i(96221),p=a.i(68114);function q(){let{user:a}=(0,e.useAuth)(),[g,q]=(0,c.useState)([]),[s,t]=(0,c.useState)(null),[u,v]=(0,c.useState)(null),[w,x]=(0,c.useState)(!0),[y,z]=(0,c.useState)(""),[A,B]=(0,c.useState)(!1),[C,D]=(0,c.useState)(null);(0,c.useEffect)(()=>{a&&E()},[a]),(0,c.useEffect)(()=>{s&&F(s)},[s]);let E=async()=>{try{let{data:b,error:c}=await d.supabase.from("family_links").select(`
                    child_id,
                    profiles:child_id (id, full_name)
                `).eq("parent_id",a?.id);if(c)throw c;let e=b.map(a=>({id:a.profiles.id,full_name:a.profiles.full_name}));q(e),e.length>0&&!s&&t(e[0].id)}catch(a){console.error("Error fetching children:",a)}finally{x(!1)}},F=async a=>{try{let{data:b}=await d.supabase.from("expenses").select("amount, type").eq("user_id",a),c=b?.filter(a=>"expense"===a.type).reduce((a,b)=>a+Number(b.amount),0)||0,{data:e}=await d.supabase.from("tasks").select("status").eq("user_id",a),f=e?.filter(a=>"done"!==a.status).length||0,g=e?.filter(a=>"done"===a.status).length||0,h=e?.length||0,i=h>0?Math.round(g/h*100):0,j=new Date().toISOString().split("T")[0],{count:k}=await d.supabase.from("meals").select("*",{count:"exact",head:!0}).eq("user_id",a).gte("timestamp",`${j}T00:00:00`);v({totalExpenses:c,activeTasks:f,completionRate:i,mealsToday:k||0})}catch(a){console.error("Error fetching child stats:",a)}},G=async b=>{b.preventDefault(),B(!0),D(null);try{let{data:b,error:c}=await d.supabase.from("profiles").select("id, role").eq("full_name",y).eq("role","child").single();if(c||!b)throw Error("Child not found. Make sure the name is correct and they have a Child account.");let{error:e}=await d.supabase.from("family_links").insert([{parent_id:a?.id,child_id:b.id}]);if(e){if("23505"===e.code)throw Error("You are already linked to this child.");throw e}z(""),E()}catch(a){D(a.message)}finally{B(!1)}};return w?(0,b.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,b.jsx)(o.Loader2,{className:"animate-spin text-primary",size:32})}):(0,b.jsxs)("div",{className:"space-y-8 animate-in fade-in duration-500",children:[(0,b.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[(0,b.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,b.jsx)("h2",{className:"text-3xl font-bold tracking-tight",children:"Parental Dashboard"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Monitor and manage your children's activities."})]}),(0,b.jsxs)("form",{onSubmit:G,className:"flex gap-2",children:[(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(m,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground",size:16}),(0,b.jsx)("input",{type:"text",placeholder:"Child's username...",value:y,onChange:a=>z(a.target.value),className:"pl-9 pr-4 py-2 bg-card border border-border rounded-xl focus:ring-2 focus:ring-primary outline-none transition-all w-full md:w-64"})]}),(0,b.jsx)("button",{type:"submit",disabled:A||!y,className:"bg-primary text-primary-foreground p-2 rounded-xl hover:bg-primary/90 disabled:opacity-50 transition-colors",children:A?(0,b.jsx)(o.Loader2,{className:"animate-spin",size:20}):(0,b.jsx)(n,{size:20})})]})]}),C&&(0,b.jsx)("div",{className:"p-3 rounded-xl bg-destructive/10 text-destructive text-sm font-medium",children:C}),0===g.length?(0,b.jsxs)("div",{className:"bg-card border-2 border-dashed border-border rounded-3xl p-12 text-center",children:[(0,b.jsx)("div",{className:"w-16 h-16 bg-primary/10 text-primary rounded-2xl flex items-center justify-center mx-auto mb-4",children:(0,b.jsx)(f.Users,{size:32})}),(0,b.jsx)("h3",{className:"text-xl font-bold mb-2",children:"No children linked yet"}),(0,b.jsx)("p",{className:"text-muted-foreground max-w-sm mx-auto",children:"Link your child's account using their username to start monitoring their tasks, expenses, and meals."})]}):(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-8",children:[(0,b.jsxs)("div",{className:"lg:col-span-1 space-y-4",children:[(0,b.jsx)("h3",{className:"text-sm font-bold uppercase tracking-widest text-muted-foreground px-2",children:"Your Family"}),(0,b.jsx)("div",{className:"space-y-2",children:g.map(a=>(0,b.jsxs)("button",{onClick:()=>t(a.id),className:(0,p.cn)("w-full flex items-center justify-between p-4 rounded-2xl border transition-all group",s===a.id?"bg-primary border-primary text-primary-foreground shadow-lg shadow-primary/20":"bg-card border-border hover:border-primary/50 text-card-foreground"),children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:(0,p.cn)("w-10 h-10 rounded-xl flex items-center justify-center font-bold text-lg",s===a.id?"bg-primary-foreground/20":"bg-primary/10 text-primary"),children:a.full_name[0].toUpperCase()}),(0,b.jsx)("span",{className:"font-bold",children:a.full_name})]}),(0,b.jsx)(l,{size:18,className:(0,p.cn)("transition-transform group-hover:translate-x-1",s===a.id?"opacity-100":"opacity-0")})]},a.id))})]}),(0,b.jsx)("div",{className:"lg:col-span-3 space-y-8",children:s&&u&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,b.jsx)(r,{title:"Total Spent",value:(0,p.formatCurrency)(u.totalExpenses),icon:j.Wallet,color:"text-red-500 bg-red-500/10"}),(0,b.jsx)(r,{title:"Active Tasks",value:u.activeTasks.toString(),icon:i.CheckCircle2,color:"text-blue-500 bg-blue-500/10"}),(0,b.jsx)(r,{title:"Completion",value:`${u.completionRate}%`,icon:h,color:"text-emerald-500 bg-emerald-500/10"}),(0,b.jsx)(r,{title:"Meals Today",value:u.mealsToday.toString(),icon:k.Calendar,color:"text-amber-500 bg-amber-500/10"})]}),(0,b.jsxs)("div",{className:"bg-card rounded-3xl border border-border p-8 text-center",children:[(0,b.jsx)("h3",{className:"text-xl font-bold mb-4",children:"Activity Log (Coming Soon)"}),(0,b.jsxs)("p",{className:"text-muted-foreground",children:["Detailed activity logging and reports for ",g.find(a=>a.id===s)?.full_name," will be available here."]})]})]})})]})]})}function r({title:a,value:c,icon:d,color:e}){return(0,b.jsxs)("div",{className:"bg-card p-6 rounded-3xl border border-border shadow-sm flex flex-col gap-4",children:[(0,b.jsx)("div",{className:(0,p.cn)("w-12 h-12 rounded-2xl flex items-center justify-center",e),children:(0,b.jsx)(d,{size:24})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-muted-foreground font-bold uppercase tracking-widest mb-1",children:a}),(0,b.jsx)("h4",{className:"text-2xl font-black tracking-tight",children:c})]})]})}var s=a.i(50944);function t(){let{profile:a,loading:d}=(0,e.useAuth)(),f=(0,s.useRouter)();return((0,c.useEffect)(()=>{!d&&a&&"parent"!==a.role&&f.push("/")},[a,d,f]),d||a&&"parent"!==a.role)?null:(0,b.jsx)(q,{})}a.s(["default",()=>t],18767)}];

//# sourceMappingURL=_59426c7d._.js.map