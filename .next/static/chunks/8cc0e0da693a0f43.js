(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,32341,e=>{"use strict";var t=e.i(43476),s=e.i(71645),u=e.i(7471);let a=(0,s.createContext)(void 0);function l({children:e}){let[l,i]=(0,s.useState)(null),[r,n]=(0,s.useState)(null),[o,d]=(0,s.useState)(!0),c=async(e,t)=>{let{data:s,error:a}=await u.supabase.from("profiles").select("*").eq("id",e).single();if(a&&"PGRST116"===a.code){let{data:s,error:a}=await u.supabase.from("profiles").insert([{id:e,full_name:t?.split("@")[0]||"User",role:"child"}]).select().single();!a&&s&&n(s)}else!a&&s&&n(s)};(0,s.useEffect)(()=>{u.supabase.auth.getSession().then(({data:{session:e}})=>{let t=e?.user??null;i(t),t&&c(t.id,t.email),d(!1)});let{data:{subscription:e}}=u.supabase.auth.onAuthStateChange((e,t)=>{let s=t?.user??null;i(s),s?c(s.id,s.email):n(null),d(!1)});return()=>e.unsubscribe()},[]);let h=async()=>{await u.supabase.auth.signOut(),n(null)};return(0,t.jsx)(a.Provider,{value:{user:l,profile:r,loading:o,signOut:h},children:e})}e.s(["AuthProvider",()=>l,"useAuth",0,()=>{let e=(0,s.useContext)(a);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}])}]);